<div class="table-scroll-container">
    <table class="table">
        <thead class="table-header">
            <tr>
                <th *ngFor="let col of columns" 
                [style.width]="col.width"
                (click)="col.key !== 'azioni' && sortBy(col.key)"
                [class.sortable]="col.key !== 'azioni'"
                [class.sorted-desc]="sortColumn === col.key && sortDirection === 'desc'"
                >{{ col.label }}
                    <span *ngIf="col.key !== 'azioni'">
                        <i 
                        class="fa"
                        [ngClass]="{
                            'fa-chevron-up': sortColumn === col.key && sortDirection === 'asc',
                            'fa-chevron-down': sortColumn === col.key && sortDirection === 'desc',
                            'fa-sort': sortColumn !== col.key
                        }"
                        ></i>
                    </span>
            </th>
                <th *ngIf="azioni.length" class="actions-column text-center">Azioni</th>
            </tr>
        </thead>
        <tbody class="table-body">
        <tr *ngFor="let row of paginatedData" class="row-clickable align-middle" (click)="rowClick.emit(row)">
            <td *ngFor="let col of columns">
                <ng-container [ngSwitch]="col.type">
                    <span *ngSwitchCase="'badge'" class="badge"
                          [class.bg-success]="row[col.key] === 'Attivo'"
                          [class.bg-secondary]="row[col.key] === 'Non attivo'">
                        {{ row[col.key] }}
                    </span>
                    <span *ngSwitchCase="'date'">{{ row[col.key] | date:'dd/MM/yyyy' }}</span>
                    <span *ngSwitchDefault>{{ row[col.key] }}</span>
                </ng-container>
            </td>
            <td *ngIf="azioni.length" class="actions-cell" (click)="$event.stopPropagation()">
                <div class="action-buttons">
                    <button *ngFor="let azione of azioni" type="button" class="btn btn-sm" [ngClass]="{
                                    'btn-primary': azione.color === 'primary',
                                    'btn-danger': azione.color === 'danger',
                                    'btn-secondary': azione.color === 'secondary',
                                    'btn-warning': azione.color === 'warning'
                                }" (click)="onAzione(azione.action, row)">
                        <i *ngIf="azione.icon" [class]="azione.icon"></i>
                    </button>
                </div>
            </td>
        </tr>
        <tr class="empty-rows" *ngFor="let empty of [].constructor(pageSize - paginatedData.length)">
            <td [attr.colspan]="columns.length + (azioni.length ? 1 : 0)">&nbsp;</td>
        </tr>
    </tbody>
    </table>
    <div class="table-footer">
        <nav *ngIf="totalPages > 0" class="table-pagination">
            <div class="table-pagination-inner">

            <ul class="pagination">
                <li class="page-item" [class.disabled]="currentPage === 1">
                    <button class="page-link" (click)="goTo(currentPage - 1)">«</button>
                </li>
                <li *ngFor="let p of pages" class="page-item" [class.active]="p === currentPage">
                    <button class="page-link" (click)="goTo(p)">{{ p }}</button>
                </li>
                <li class="page-item" [class.disabled]="currentPage === totalPages">
                    <button class="page-link" (click)="goTo(currentPage + 1)">»</button>
                </li>
            </ul>
            <span class="pagination-info">
                Pagina {{ currentPage }} di {{ totalPages }}
                <span *ngIf="paginatedData.length && data.length">
                    (Visualizzati {{ ((currentPage - 1) * pageSize) + paginatedData.length }} corsi su {{ data.length }} disponibili)
                </span>
            </span>
            </div>
        </nav>
    </div>
</div>